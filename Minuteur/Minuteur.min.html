<!doctype html><html lang=fr><meta charset=UTF-8><title>Minuteur</title><script>let totalSecondsToRun=0,currentSeconds=0,isRunning=!1,isFinished=!1,timeoutInterval=0,expectedCallTime=null,timeoutId=null,isSoundAllowed=!0;function onTimeInput(e){e&&displayTimes(splitInput(e.target.value))}function onInputBlur(e){if(isRunning)return;let n=splitInput(e.target.value);if(calculateSecondsToRun(n),n=sanitiseTime(totalSecondsToRun),displayTimes(n),totalSecondsToRun>0){let t=`${n.hours}`.padStart(2,"0")+`${n.minutes}`.padStart(2,"0")+`${n.seconds}`.padStart(2,"0");t=t.replaceAll(/^0+/g,""),e.target.value=t}else e.target.value=""}function onInputKeyUp(e){13!==e.keyCode||isRunning||(onInputBlur(e),toggleTimer())}function toggleTimer(){isRunning?timerOff():timerOn()}function restartTimer(){isRunning&&timerOff(),currentSeconds=totalSecondsToRun,displayTimes(sanitiseTime(currentSeconds))}function toggleSound(){isSoundAllowed=!isSoundAllowed,isSoundAllowed||(stopSound(),isFinished&&(isRunning=!1,updateUi())),updateUi()}function clearInput(){document.querySelector("#timeInput").value="",displayTimes({})}function reverseString(e){return e.split("").reduce(((e,n)=>n+e),"")}function splitInput(e){const n=reverseString(e),t=n?.match(/.{1,2}/g)?.map(reverseString)?.map((e=>parseInt(e)))||[];return{seconds:t?.[0]||0,minutes:t?.[1]||0,hours:t?.[2]||0}}function calculateSecondsToRun(e){totalSecondsToRun=60*(60*e.hours+e.minutes)+e.seconds,currentSeconds=totalSecondsToRun}function sanitiseTime(e){const n={};return n.seconds=e%60,e=(e-n.seconds)/60,n.minutes=e%60,e=(e-n.minutes)/60,n.hours=e,n}function displayTimes({hours:e=0,minutes:n=0,seconds:t=0}){document.querySelector("#seconds").innerText=`${t}`.padStart(2,"0")+"s";document.querySelector("#minutes").innerText=`${n}`.padStart(2,"0")+"m";document.querySelector("#hours").innerText=`${e}`.padStart(2,"0")+"h"}function timerOff(){clearTimeout(timeoutId),stopSound(),isRunning=!1,updateUi()}function timerOn(){currentSeconds>0&&(timeoutInterval=1e3,expectedCallTime=Date.now()+timeoutInterval,timeoutId=setTimeout(step,timeoutInterval),isRunning=!0,updateUi())}function step(){currentSeconds-=1,displayTimes(sanitiseTime(currentSeconds));const e=Date.now()-expectedCallTime;expectedCallTime+=timeoutInterval,currentSeconds<=0&&!isFinished?isSoundAllowed?(playSound(),isFinished=!0):(isRunning=!1,updateUi()):isRunning&&(timeoutId=setTimeout(step,Math.max(0,timeoutInterval-e)))}function playSound(){const e=document.querySelector("#timeAudio");e.volume=.5,e.play()}function stopSound(){document.querySelector("#timeAudio").pause()}function updateUi(){document.querySelector("#toggleButton").innerText=isRunning?"ARRÊTER":"DÉMARRER";document.querySelector("#timeInput").disabled=isRunning;const e=document.querySelector("#soundOn"),n=document.querySelector("#soundOff");isSoundAllowed?(e.classList.remove("hidden"),n.classList.add("hidden")):(e.classList.add("hidden"),n.classList.remove("hidden"))}</script><style>body{font-family:"Segoe UI",Arial,sans-serif}input{border:none;text-align:right;position:absolute;top:1rem;right:1rem;left:1rem;bottom:1rem;background-color:transparent;color:transparent;caret-color:#4299e1}input:focus{outline:0;border-bottom:1px solid #4299e1}.relative{position:relative}.flex{display:flex}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.w-full{width:100%}.ml-auto{margin-left:auto}.mr-auto{margin-right:auto}.m-0{margin:0}.mr-4{margin-right:1rem}.p-4{padding:1rem}.hidden{display:none}.overflow-none{overflow:hidden}.btn-primary{background-color:#4299e1;cursor:pointer;color:#fff;padding:.5rem 1rem;border-radius:.25rem;border:0}.btn-primary:hover{background-color:#2b6cb0}.btn-transparent{background-color:transparent;border:0;border-radius:.25rem;padding:.5rem}.btn-transparent:hover{background-color:rgba(0,0,0,.1)}.border{border-width:1px;border-style:solid}.border-gray-100{border-color:rgba(0,0,0,.1)}.time-field{font-size:4rem;font-weight:700}.icon{width:1.25em;height:1.25em;vertical-align:-.125em}.rounded{border-radius:.25rem}</style><div class="flex flex-row"><div class="flex flex-col border border-gray-100 rounded overflow-none"><div class="p-4 flex flex-row relative"><span id=hours class="mr-4 time-field">00h</span> <span id=minutes class="mr-4 time-field">00m</span> <span id=seconds class=time-field>00s</span> <input id=timeInput pattern=\d class=time-field oninput=onTimeInput(event) onkeyup=onInputKeyUp(event) onblur=onInputBlur(event)><audio id=timeAudio loop><source src=https://cdn.freesound.org/previews/536/536420_4921277-lq.mp3 type=audio/mpeg><source src=https://cdn.freesound.org/previews/536/536420_4921277-lq.ogg type=audio/ogg></audio></div><hr class="w-full m-0 border-gray-100"><div class="p-4 flex flex-row"><button id=toggleButton class="btn-primary mr-4" onclick=toggleTimer()>DÉMARRER</button> <button id=restartButton class="btn-primary mr-auto" onclick=restartTimer()>RESET</button> <button id=soundButton class=btn-transparent onclick=toggleSound()><svg id=soundOn xmlns=http://www.w3.org/2000/svg viewBox="0 0 640 512" class=icon><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill=currentColor d="M533.6 32.5C598.5 85.2 640 165.8 640 256s-41.5 170.7-106.4 223.5c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C557.5 398.2 592 331.2 592 256s-34.5-142.2-88.7-186.3c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zM473.1 107c43.2 35.2 70.9 88.9 70.9 149s-27.7 113.8-70.9 149c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C475.3 341.3 496 301.1 496 256s-20.7-85.3-53.2-111.8c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zm-60.5 74.5C434.1 199.1 448 225.9 448 256s-13.9 56.9-35.4 74.5c-10.3 8.4-25.4 6.8-33.8-3.5s-6.8-25.4 3.5-33.8C393.1 284.4 400 271 400 256s-6.9-28.4-17.7-37.3c-10.3-8.4-11.8-23.5-3.5-33.8s23.5-11.8 33.8-3.5zM301.1 34.8C312.6 40 320 51.4 320 64V448c0 12.6-7.4 24-18.9 29.2s-25 3.1-34.4-5.3L131.8 352H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64h67.8L266.7 40.1c9.4-8.4 22.9-10.4 34.4-5.3z"/></svg> <svg id=soundOff xmlns=http://www.w3.org/2000/svg viewBox="0 0 576 512" class="icon hidden"><!--!Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill=currentColor d="M301.1 34.8C312.6 40 320 51.4 320 64V448c0 12.6-7.4 24-18.9 29.2s-25 3.1-34.4-5.3L131.8 352H64c-35.3 0-64-28.7-64-64V224c0-35.3 28.7-64 64-64h67.8L266.7 40.1c9.4-8.4 22.9-10.4 34.4-5.3zM425 167l55 55 55-55c9.4-9.4 24.6-9.4 33.9 0s9.4 24.6 0 33.9l-55 55 55 55c9.4 9.4 9.4 24.6 0 33.9s-24.6 9.4-33.9 0l-55-55-55 55c-9.4 9.4-24.6 9.4-33.9 0s-9.4-24.6 0-33.9l55-55-55-55c-9.4-9.4-9.4-24.6 0-33.9s24.6-9.4 33.9 0z"/></svg></button> <button id=clearButton class=btn-transparent onclick=clearInput()><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 384 512" class=icon><!--!Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free Copyright 2024 Fonticons, Inc.--><path fill=currentColor d="M342.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L192 210.7 86.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L146.7 256 41.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 301.3 297.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L237.3 256 342.6 150.6z"/></svg></button></div></div></div>
